;; gorilla-repl.fileformat = 1

;; **
;;; # Replikativ example
;; **

;; @@
(ns sunset-beach
  (:require [gorilla-repl.vega :as v]
            [geschichte-gorilla.core :as g]))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-nil'>nil</span>","value":"nil"}
;; <=

;; @@
(def test-repo
  (atom
    {:commit-graph {10 []}
     :commits
     {10 "master"}
     :branches {"master" #{10}}}))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;sunset-beach/test-repo</span>","value":"#'sunset-beach/test-repo"}
;; <=

;; @@
(defn plot-graph [repo]
  (v/vega-view (g/vega-commit-graph (:commit-graph repo) (:branches repo) (:commits repo)))
  )
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;sunset-beach/plot-graph</span>","value":"#'sunset-beach/plot-graph"}
;; <=

;; **
;;; Bare repo
;; **

;; @@
(plot-graph @test-repo)
;; @@
;; =>
;;; {"type":"vega","content":{"width":600,"height":370.82818603515625,"padding":{"top":10,"left":50,"bottom":20,"right":10},"marks":[{"type":"path","from":{"data":"links"},"properties":{"enter":{"path":{"field":"data.path"},"strokeWidth":{"value":2},"stroke":{"r":{"field":"data.r"},"g":{"field":"data.g"},"b":{"field":"data.b"}}}}},{"type":"symbol","from":{"data":"nodes"},"properties":{"enter":{"x":{"field":"data.x"},"y":{"field":"data.y"},"fill":{"r":{"field":"data.r"},"g":{"field":"data.g"},"b":{"field":"data.b"}},"fillOpacity":{"value":"1"}},"update":{"shape":"circle","size":{"value":110},"stroke":["value","transparent"]}}},{"type":"text","from":{"data":"labels"},"properties":{"enter":{"x":{"field":"data.x"},"y":{"field":"data.y"},"align":{"value":"left"},"dx":{"value":10},"fontSize":{"value":15},"fill":{"value":"black"}},"update":{"text":{"field":"data.value"}}}}],"data":[{"name":"nodes","values":[{"value":10,"x":570.0,"y":185.41409301757812,"r":133,"g":30,"b":194}]},{"name":"links","values":[]},{"name":"labels","values":[{"value":"master","x":570.0,"y":185.41409301757812}]}]},"value":"#gorilla_repl.vega.VegaView{:content {:width 600, :height 370.8282, :padding {:top 10, :left 50, :bottom 20, :right 10}, :marks [{:type \"path\", :from {:data \"links\"}, :properties {:enter {:path {:field \"data.path\"}, :strokeWidth {:value 2}, :stroke {:r {:field \"data.r\"}, :g {:field \"data.g\"}, :b {:field \"data.b\"}}}}} {:type \"symbol\", :from {:data \"nodes\"}, :properties {:enter {:x {:field \"data.x\"}, :y {:field \"data.y\"}, :fill {:r {:field \"data.r\"}, :g {:field \"data.g\"}, :b {:field \"data.b\"}}, :fillOpacity {:value \"1\"}}, :update {:shape \"circle\", :size {:value 110}, :stroke [:value \"transparent\"]}}} {:type \"text\", :from {:data \"labels\"}, :properties {:enter {:x {:field \"data.x\"}, :y {:field \"data.y\"}, :align {:value \"left\"}, :dx {:value 10}, :fontSize {:value 15}, :fill {:value \"black\"}}, :update {:text {:field \"data.value\"}}}}], :data [{:name \"nodes\", :values [{:value 10, :x 570.0, :y 185.41409301757812, :r 133, :g 30, :b 194}]} {:name \"links\", :values []} {:name \"labels\", :values [{:value \"master\", :x 570.0, :y 185.41409301757812}]}]}}"}
;; <=

;; **
;;; Commit some things to "master" branch
;; **

;; @@
(swap! test-repo #(assoc-in % [:commit-graph 20] [10]))
(swap! test-repo #(assoc-in % [:commits 20] "master"))
(swap! test-repo #(assoc-in % [:branches "master"] #{20}))
(plot-graph @test-repo)
;; @@
;; =>
;;; {"type":"vega","content":{"width":600,"height":370.82818603515625,"padding":{"top":10,"left":50,"bottom":20,"right":10},"marks":[{"type":"path","from":{"data":"links"},"properties":{"enter":{"path":{"field":"data.path"},"strokeWidth":{"value":2},"stroke":{"r":{"field":"data.r"},"g":{"field":"data.g"},"b":{"field":"data.b"}}}}},{"type":"symbol","from":{"data":"nodes"},"properties":{"enter":{"x":{"field":"data.x"},"y":{"field":"data.y"},"fill":{"r":{"field":"data.r"},"g":{"field":"data.g"},"b":{"field":"data.b"}},"fillOpacity":{"value":"1"}},"update":{"shape":"circle","size":{"value":110},"stroke":["value","transparent"]}}},{"type":"text","from":{"data":"labels"},"properties":{"enter":{"x":{"field":"data.x"},"y":{"field":"data.y"},"align":{"value":"left"},"dx":{"value":10},"fontSize":{"value":15},"fill":{"value":"black"}},"update":{"text":{"field":"data.value"}}}}],"data":[{"name":"nodes","values":[{"value":10,"x":30.0,"y":185.41409301757812,"r":163,"g":42,"b":248},{"value":20,"x":570.0,"y":185.41409301757812,"r":163,"g":42,"b":248}]},{"name":"links","values":[{"path":"M 30.000000447034836 185.41409301757812 L 569.9999928474426 185.41409301757812","r":163,"g":42,"b":248}]},{"name":"labels","values":[{"value":"master","x":570.0,"y":185.41409301757812}]}]},"value":"#gorilla_repl.vega.VegaView{:content {:width 600, :height 370.8282, :padding {:top 10, :left 50, :bottom 20, :right 10}, :marks [{:type \"path\", :from {:data \"links\"}, :properties {:enter {:path {:field \"data.path\"}, :strokeWidth {:value 2}, :stroke {:r {:field \"data.r\"}, :g {:field \"data.g\"}, :b {:field \"data.b\"}}}}} {:type \"symbol\", :from {:data \"nodes\"}, :properties {:enter {:x {:field \"data.x\"}, :y {:field \"data.y\"}, :fill {:r {:field \"data.r\"}, :g {:field \"data.g\"}, :b {:field \"data.b\"}}, :fillOpacity {:value \"1\"}}, :update {:shape \"circle\", :size {:value 110}, :stroke [:value \"transparent\"]}}} {:type \"text\", :from {:data \"labels\"}, :properties {:enter {:x {:field \"data.x\"}, :y {:field \"data.y\"}, :align {:value \"left\"}, :dx {:value 10}, :fontSize {:value 15}, :fill {:value \"black\"}}, :update {:text {:field \"data.value\"}}}}], :data [{:name \"nodes\", :values [{:value 10, :x 30.0, :y 185.41409301757812, :r 163, :g 42, :b 248} {:value 20, :x 570.0, :y 185.41409301757812, :r 163, :g 42, :b 248}]} {:name \"links\", :values [{:path \"M 30.000000447034836 185.41409301757812 L 569.9999928474426 185.41409301757812\", :r 163, :g 42, :b 248}]} {:name \"labels\", :values [{:value \"master\", :x 570.0, :y 185.41409301757812}]}]}}"}
;; <=

;; @@
(swap! test-repo #(assoc-in % [:commit-graph 30] [20]))
(swap! test-repo #(assoc-in % [:commits 30] "master"))
(swap! test-repo #(assoc-in % [:branches "master"] #{30}))
(plot-graph @test-repo)
;; @@
;; =>
;;; {"type":"vega","content":{"width":600,"height":370.82818603515625,"padding":{"top":10,"left":50,"bottom":20,"right":10},"marks":[{"type":"path","from":{"data":"links"},"properties":{"enter":{"path":{"field":"data.path"},"strokeWidth":{"value":2},"stroke":{"r":{"field":"data.r"},"g":{"field":"data.g"},"b":{"field":"data.b"}}}}},{"type":"symbol","from":{"data":"nodes"},"properties":{"enter":{"x":{"field":"data.x"},"y":{"field":"data.y"},"fill":{"r":{"field":"data.r"},"g":{"field":"data.g"},"b":{"field":"data.b"}},"fillOpacity":{"value":"1"}},"update":{"shape":"circle","size":{"value":110},"stroke":["value","transparent"]}}},{"type":"text","from":{"data":"labels"},"properties":{"enter":{"x":{"field":"data.x"},"y":{"field":"data.y"},"align":{"value":"left"},"dx":{"value":10},"fontSize":{"value":15},"fill":{"value":"black"}},"update":{"text":{"field":"data.value"}}}}],"data":[{"name":"nodes","values":[{"value":10,"x":30.0,"y":185.41409301757812,"r":30,"g":164,"b":198},{"value":20,"x":299.99999999999994,"y":185.41409301757812,"r":30,"g":164,"b":198},{"value":30,"x":570.0,"y":185.41409301757812,"r":30,"g":164,"b":198}]},{"name":"links","values":[{"path":"M 30.000000447034836 185.41409301757812 L 300.0 185.41409301757812","r":30,"g":164,"b":198},{"path":"M 300.0 185.41409301757812 L 569.9999928474426 185.41409301757812","r":30,"g":164,"b":198}]},{"name":"labels","values":[{"value":"master","x":570.0,"y":185.41409301757812}]}]},"value":"#gorilla_repl.vega.VegaView{:content {:width 600, :height 370.8282, :padding {:top 10, :left 50, :bottom 20, :right 10}, :marks [{:type \"path\", :from {:data \"links\"}, :properties {:enter {:path {:field \"data.path\"}, :strokeWidth {:value 2}, :stroke {:r {:field \"data.r\"}, :g {:field \"data.g\"}, :b {:field \"data.b\"}}}}} {:type \"symbol\", :from {:data \"nodes\"}, :properties {:enter {:x {:field \"data.x\"}, :y {:field \"data.y\"}, :fill {:r {:field \"data.r\"}, :g {:field \"data.g\"}, :b {:field \"data.b\"}}, :fillOpacity {:value \"1\"}}, :update {:shape \"circle\", :size {:value 110}, :stroke [:value \"transparent\"]}}} {:type \"text\", :from {:data \"labels\"}, :properties {:enter {:x {:field \"data.x\"}, :y {:field \"data.y\"}, :align {:value \"left\"}, :dx {:value 10}, :fontSize {:value 15}, :fill {:value \"black\"}}, :update {:text {:field \"data.value\"}}}}], :data [{:name \"nodes\", :values [{:value 10, :x 30.0, :y 185.41409301757812, :r 30, :g 164, :b 198} {:value 20, :x 299.99999999999994, :y 185.41409301757812, :r 30, :g 164, :b 198} {:value 30, :x 570.0, :y 185.41409301757812, :r 30, :g 164, :b 198}]} {:name \"links\", :values [{:path \"M 30.000000447034836 185.41409301757812 L 300.0 185.41409301757812\", :r 30, :g 164, :b 198} {:path \"M 300.0 185.41409301757812 L 569.9999928474426 185.41409301757812\", :r 30, :g 164, :b 198}]} {:name \"labels\", :values [{:value \"master\", :x 570.0, :y 185.41409301757812}]}]}}"}
;; <=

;; @@
(swap! test-repo #(assoc-in % [:commit-graph 40] [30]))
(swap! test-repo #(assoc-in % [:commits 40] "master"))
(swap! test-repo #(assoc-in % [:branches "master"] #{40}))
(plot-graph @test-repo)
;; @@
;; =>
;;; {"type":"vega","content":{"width":600,"height":370.82818603515625,"padding":{"top":10,"left":50,"bottom":20,"right":10},"marks":[{"type":"path","from":{"data":"links"},"properties":{"enter":{"path":{"field":"data.path"},"strokeWidth":{"value":2},"stroke":{"r":{"field":"data.r"},"g":{"field":"data.g"},"b":{"field":"data.b"}}}}},{"type":"symbol","from":{"data":"nodes"},"properties":{"enter":{"x":{"field":"data.x"},"y":{"field":"data.y"},"fill":{"r":{"field":"data.r"},"g":{"field":"data.g"},"b":{"field":"data.b"}},"fillOpacity":{"value":"1"}},"update":{"shape":"circle","size":{"value":110},"stroke":["value","transparent"]}}},{"type":"text","from":{"data":"labels"},"properties":{"enter":{"x":{"field":"data.x"},"y":{"field":"data.y"},"align":{"value":"left"},"dx":{"value":10},"fontSize":{"value":15},"fill":{"value":"black"}},"update":{"text":{"field":"data.value"}}}}],"data":[{"name":"nodes","values":[{"value":10,"x":30.0,"y":185.41409301757812,"r":98,"g":36,"b":218},{"value":20,"x":209.99999999999977,"y":185.41409301757812,"r":98,"g":36,"b":218},{"value":30,"x":389.9999999999998,"y":185.41409301757812,"r":98,"g":36,"b":218},{"value":40,"x":570.0,"y":185.41409301757812,"r":98,"g":36,"b":218}]},{"name":"links","values":[{"path":"M 30.000000447034836 185.41409301757812 L 209.9999964237213 185.41409301757812","r":98,"g":36,"b":218},{"path":"M 209.9999964237213 185.41409301757812 L 389.99998569488525 185.41409301757812","r":98,"g":36,"b":218},{"path":"M 389.99998569488525 185.41409301757812 L 569.9999928474426 185.41409301757812","r":98,"g":36,"b":218}]},{"name":"labels","values":[{"value":"master","x":570.0,"y":185.41409301757812}]}]},"value":"#gorilla_repl.vega.VegaView{:content {:width 600, :height 370.8282, :padding {:top 10, :left 50, :bottom 20, :right 10}, :marks [{:type \"path\", :from {:data \"links\"}, :properties {:enter {:path {:field \"data.path\"}, :strokeWidth {:value 2}, :stroke {:r {:field \"data.r\"}, :g {:field \"data.g\"}, :b {:field \"data.b\"}}}}} {:type \"symbol\", :from {:data \"nodes\"}, :properties {:enter {:x {:field \"data.x\"}, :y {:field \"data.y\"}, :fill {:r {:field \"data.r\"}, :g {:field \"data.g\"}, :b {:field \"data.b\"}}, :fillOpacity {:value \"1\"}}, :update {:shape \"circle\", :size {:value 110}, :stroke [:value \"transparent\"]}}} {:type \"text\", :from {:data \"labels\"}, :properties {:enter {:x {:field \"data.x\"}, :y {:field \"data.y\"}, :align {:value \"left\"}, :dx {:value 10}, :fontSize {:value 15}, :fill {:value \"black\"}}, :update {:text {:field \"data.value\"}}}}], :data [{:name \"nodes\", :values [{:value 10, :x 30.0, :y 185.41409301757812, :r 98, :g 36, :b 218} {:value 20, :x 209.99999999999977, :y 185.41409301757812, :r 98, :g 36, :b 218} {:value 30, :x 389.9999999999998, :y 185.41409301757812, :r 98, :g 36, :b 218} {:value 40, :x 570.0, :y 185.41409301757812, :r 98, :g 36, :b 218}]} {:name \"links\", :values [{:path \"M 30.000000447034836 185.41409301757812 L 209.9999964237213 185.41409301757812\", :r 98, :g 36, :b 218} {:path \"M 209.9999964237213 185.41409301757812 L 389.99998569488525 185.41409301757812\", :r 98, :g 36, :b 218} {:path \"M 389.99998569488525 185.41409301757812 L 569.9999928474426 185.41409301757812\", :r 98, :g 36, :b 218}]} {:name \"labels\", :values [{:value \"master\", :x 570.0, :y 185.41409301757812}]}]}}"}
;; <=

;; **
;;; Create a new branch and commit to it:
;; **

;; @@
(swap! test-repo #(assoc-in % [:commit-graph 50] [30]))
(swap! test-repo #(assoc-in % [:commits 50] "dev"))
(swap! test-repo #(assoc-in % [:branches "dev"] #{50}))
(plot-graph @test-repo)
;; @@
;; =>
;;; {"type":"vega","content":{"width":600,"height":370.82818603515625,"padding":{"top":10,"left":50,"bottom":20,"right":10},"marks":[{"type":"path","from":{"data":"links"},"properties":{"enter":{"path":{"field":"data.path"},"strokeWidth":{"value":2},"stroke":{"r":{"field":"data.r"},"g":{"field":"data.g"},"b":{"field":"data.b"}}}}},{"type":"symbol","from":{"data":"nodes"},"properties":{"enter":{"x":{"field":"data.x"},"y":{"field":"data.y"},"fill":{"r":{"field":"data.r"},"g":{"field":"data.g"},"b":{"field":"data.b"}},"fillOpacity":{"value":"1"}},"update":{"shape":"circle","size":{"value":110},"stroke":["value","transparent"]}}},{"type":"text","from":{"data":"labels"},"properties":{"enter":{"x":{"field":"data.x"},"y":{"field":"data.y"},"align":{"value":"left"},"dx":{"value":10},"fontSize":{"value":15},"fill":{"value":"black"}},"update":{"text":{"field":"data.value"}}}}],"data":[{"name":"nodes","values":[{"value":10,"x":30.0,"y":123.60939534505208,"r":168,"g":134,"b":253},{"value":20,"x":245.99999999999983,"y":123.60939534505208,"r":168,"g":134,"b":253},{"value":30,"x":461.99999999999983,"y":123.60939534505208,"r":168,"g":134,"b":253},{"value":40,"x":570.0,"y":123.60939534505208,"r":168,"g":134,"b":253},{"value":50,"x":570.0,"y":247.21879069010419,"r":33,"g":4,"b":201}]},{"name":"links","values":[{"path":"M 30.000000447034836 123.60939902889913 L 245.9999978542328 123.60939902889913","r":168,"g":134,"b":253},{"path":"M 245.9999978542328 123.60939902889913 L 461.9999885559082 123.60939902889913","r":168,"g":134,"b":253},{"path":"M 461.9999885559082 123.60939902889913 L 569.9999928474426 123.60939902889913","r":168,"g":134,"b":253},{"path":"M 461.9999885559082 123.60939902889913 L 569.9999928474426 247.21879805779827","r":33,"g":4,"b":201}]},{"name":"labels","values":[{"value":"master","x":570.0,"y":123.60939534505208},{"value":"dev","x":570.0,"y":247.21879069010419}]}]},"value":"#gorilla_repl.vega.VegaView{:content {:width 600, :height 370.8282, :padding {:top 10, :left 50, :bottom 20, :right 10}, :marks [{:type \"path\", :from {:data \"links\"}, :properties {:enter {:path {:field \"data.path\"}, :strokeWidth {:value 2}, :stroke {:r {:field \"data.r\"}, :g {:field \"data.g\"}, :b {:field \"data.b\"}}}}} {:type \"symbol\", :from {:data \"nodes\"}, :properties {:enter {:x {:field \"data.x\"}, :y {:field \"data.y\"}, :fill {:r {:field \"data.r\"}, :g {:field \"data.g\"}, :b {:field \"data.b\"}}, :fillOpacity {:value \"1\"}}, :update {:shape \"circle\", :size {:value 110}, :stroke [:value \"transparent\"]}}} {:type \"text\", :from {:data \"labels\"}, :properties {:enter {:x {:field \"data.x\"}, :y {:field \"data.y\"}, :align {:value \"left\"}, :dx {:value 10}, :fontSize {:value 15}, :fill {:value \"black\"}}, :update {:text {:field \"data.value\"}}}}], :data [{:name \"nodes\", :values [{:value 10, :x 30.0, :y 123.60939534505208, :r 168, :g 134, :b 253} {:value 20, :x 245.99999999999983, :y 123.60939534505208, :r 168, :g 134, :b 253} {:value 30, :x 461.99999999999983, :y 123.60939534505208, :r 168, :g 134, :b 253} {:value 40, :x 570.0, :y 123.60939534505208, :r 168, :g 134, :b 253} {:value 50, :x 570.0, :y 247.21879069010419, :r 33, :g 4, :b 201}]} {:name \"links\", :values [{:path \"M 30.000000447034836 123.60939902889913 L 245.9999978542328 123.60939902889913\", :r 168, :g 134, :b 253} {:path \"M 245.9999978542328 123.60939902889913 L 461.9999885559082 123.60939902889913\", :r 168, :g 134, :b 253} {:path \"M 461.9999885559082 123.60939902889913 L 569.9999928474426 123.60939902889913\", :r 168, :g 134, :b 253} {:path \"M 461.9999885559082 123.60939902889913 L 569.9999928474426 247.21879805779827\", :r 33, :g 4, :b 201}]} {:name \"labels\", :values [{:value \"master\", :x 570.0, :y 123.60939534505208} {:value \"dev\", :x 570.0, :y 247.21879069010419}]}]}}"}
;; <=

;; @@
(swap! test-repo #(assoc-in % [:commit-graph 60] [50]))
(swap! test-repo #(assoc-in % [:commits 60] "dev"))
(swap! test-repo #(assoc-in % [:branches "dev"] #{60}))
(plot-graph @test-repo)
;; @@
;; =>
;;; {"type":"vega","content":{"width":600,"height":370.82818603515625,"padding":{"top":10,"left":50,"bottom":20,"right":10},"marks":[{"type":"path","from":{"data":"links"},"properties":{"enter":{"path":{"field":"data.path"},"strokeWidth":{"value":2},"stroke":{"r":{"field":"data.r"},"g":{"field":"data.g"},"b":{"field":"data.b"}}}}},{"type":"symbol","from":{"data":"nodes"},"properties":{"enter":{"x":{"field":"data.x"},"y":{"field":"data.y"},"fill":{"r":{"field":"data.r"},"g":{"field":"data.g"},"b":{"field":"data.b"}},"fillOpacity":{"value":"1"}},"update":{"shape":"circle","size":{"value":110},"stroke":["value","transparent"]}}},{"type":"text","from":{"data":"labels"},"properties":{"enter":{"x":{"field":"data.x"},"y":{"field":"data.y"},"align":{"value":"left"},"dx":{"value":10},"fontSize":{"value":15},"fill":{"value":"black"}},"update":{"text":{"field":"data.value"}}}}],"data":[{"name":"nodes","values":[{"value":10,"x":30.0,"y":123.60939534505208,"r":158,"g":115,"b":46},{"value":20,"x":232.49999999999977,"y":123.60939534505208,"r":158,"g":115,"b":46},{"value":30,"x":434.9999999999997,"y":123.60939534505208,"r":158,"g":115,"b":46},{"value":40,"x":570.0,"y":123.60939534505208,"r":158,"g":115,"b":46},{"value":50,"x":502.49999999999966,"y":247.21879069010419,"r":107,"g":237,"b":116},{"value":60,"x":570.0,"y":247.21879069010419,"r":107,"g":237,"b":116}]},{"name":"links","values":[{"path":"M 30.000000447034836 123.60939902889913 L 232.49999284744263 123.60939902889913","r":158,"g":115,"b":46},{"path":"M 232.49999284744263 123.60939902889913 L 435.00001430511475 123.60939902889913","r":158,"g":115,"b":46},{"path":"M 435.00001430511475 123.60939902889913 L 569.9999928474426 123.60939902889913","r":158,"g":115,"b":46},{"path":"M 502.49998569488525 247.21879805779827 L 569.9999928474426 247.21879805779827","r":107,"g":237,"b":116},{"path":"M 435.00001430511475 123.60939902889913 L 502.49998569488525 247.21879805779827","r":107,"g":237,"b":116}]},{"name":"labels","values":[{"value":"master","x":570.0,"y":123.60939534505208},{"value":"dev","x":570.0,"y":247.21879069010419}]}]},"value":"#gorilla_repl.vega.VegaView{:content {:width 600, :height 370.8282, :padding {:top 10, :left 50, :bottom 20, :right 10}, :marks [{:type \"path\", :from {:data \"links\"}, :properties {:enter {:path {:field \"data.path\"}, :strokeWidth {:value 2}, :stroke {:r {:field \"data.r\"}, :g {:field \"data.g\"}, :b {:field \"data.b\"}}}}} {:type \"symbol\", :from {:data \"nodes\"}, :properties {:enter {:x {:field \"data.x\"}, :y {:field \"data.y\"}, :fill {:r {:field \"data.r\"}, :g {:field \"data.g\"}, :b {:field \"data.b\"}}, :fillOpacity {:value \"1\"}}, :update {:shape \"circle\", :size {:value 110}, :stroke [:value \"transparent\"]}}} {:type \"text\", :from {:data \"labels\"}, :properties {:enter {:x {:field \"data.x\"}, :y {:field \"data.y\"}, :align {:value \"left\"}, :dx {:value 10}, :fontSize {:value 15}, :fill {:value \"black\"}}, :update {:text {:field \"data.value\"}}}}], :data [{:name \"nodes\", :values [{:value 10, :x 30.0, :y 123.60939534505208, :r 158, :g 115, :b 46} {:value 20, :x 232.49999999999977, :y 123.60939534505208, :r 158, :g 115, :b 46} {:value 30, :x 434.9999999999997, :y 123.60939534505208, :r 158, :g 115, :b 46} {:value 40, :x 570.0, :y 123.60939534505208, :r 158, :g 115, :b 46} {:value 50, :x 502.49999999999966, :y 247.21879069010419, :r 107, :g 237, :b 116} {:value 60, :x 570.0, :y 247.21879069010419, :r 107, :g 237, :b 116}]} {:name \"links\", :values [{:path \"M 30.000000447034836 123.60939902889913 L 232.49999284744263 123.60939902889913\", :r 158, :g 115, :b 46} {:path \"M 232.49999284744263 123.60939902889913 L 435.00001430511475 123.60939902889913\", :r 158, :g 115, :b 46} {:path \"M 435.00001430511475 123.60939902889913 L 569.9999928474426 123.60939902889913\", :r 158, :g 115, :b 46} {:path \"M 502.49998569488525 247.21879805779827 L 569.9999928474426 247.21879805779827\", :r 107, :g 237, :b 116} {:path \"M 435.00001430511475 123.60939902889913 L 502.49998569488525 247.21879805779827\", :r 107, :g 237, :b 116}]} {:name \"labels\", :values [{:value \"master\", :x 570.0, :y 123.60939534505208} {:value \"dev\", :x 570.0, :y 247.21879069010419}]}]}}"}
;; <=

;; @@
(swap! test-repo #(assoc-in % [:commit-graph 70] [60]))
(swap! test-repo #(assoc-in % [:commits 70] "dev"))
(swap! test-repo #(assoc-in % [:branches "dev"] #{70}))
(plot-graph @test-repo)
;; @@
;; =>
;;; {"type":"vega","content":{"width":600,"height":370.82818603515625,"padding":{"top":10,"left":50,"bottom":20,"right":10},"marks":[{"type":"path","from":{"data":"links"},"properties":{"enter":{"path":{"field":"data.path"},"strokeWidth":{"value":2},"stroke":{"r":{"field":"data.r"},"g":{"field":"data.g"},"b":{"field":"data.b"}}}}},{"type":"symbol","from":{"data":"nodes"},"properties":{"enter":{"x":{"field":"data.x"},"y":{"field":"data.y"},"fill":{"r":{"field":"data.r"},"g":{"field":"data.g"},"b":{"field":"data.b"}},"fillOpacity":{"value":"1"}},"update":{"shape":"circle","size":{"value":110},"stroke":["value","transparent"]}}},{"type":"text","from":{"data":"labels"},"properties":{"enter":{"x":{"field":"data.x"},"y":{"field":"data.y"},"align":{"value":"left"},"dx":{"value":10},"fontSize":{"value":15},"fill":{"value":"black"}},"update":{"text":{"field":"data.value"}}}}],"data":[{"name":"nodes","values":[{"value":10,"x":30.0,"y":123.60939534505208,"r":155,"g":147,"b":9},{"value":20,"x":226.3636363636361,"y":123.60939534505208,"r":155,"g":147,"b":9},{"value":30,"x":422.72727272727235,"y":123.60939534505208,"r":155,"g":147,"b":9},{"value":40,"x":570.0,"y":123.60939534505208,"r":155,"g":147,"b":9},{"value":50,"x":471.81818181818124,"y":247.21879069010419,"r":76,"g":98,"b":19},{"value":60,"x":520.9090909090904,"y":247.21879069010419,"r":76,"g":98,"b":19},{"value":70,"x":570.0,"y":247.21879069010419,"r":76,"g":98,"b":19}]},{"name":"links","values":[{"path":"M 30.000000447034836 123.60939902889913 L 226.3636350631714 123.60939902889913","r":155,"g":147,"b":9},{"path":"M 226.3636350631714 123.60939902889913 L 422.7272629737854 123.60939902889913","r":155,"g":147,"b":9},{"path":"M 422.7272629737854 123.60939902889913 L 569.9999928474426 123.60939902889913","r":155,"g":147,"b":9},{"path":"M 471.81819677352905 247.21879805779827 L 520.9090948104858 247.21879805779827","r":76,"g":98,"b":19},{"path":"M 520.9090948104858 247.21879805779827 L 569.9999928474426 247.21879805779827","r":76,"g":98,"b":19},{"path":"M 422.7272629737854 123.60939902889913 L 471.81819677352905 247.21879805779827","r":76,"g":98,"b":19}]},{"name":"labels","values":[{"value":"master","x":570.0,"y":123.60939534505208},{"value":"dev","x":570.0,"y":247.21879069010419}]}]},"value":"#gorilla_repl.vega.VegaView{:content {:width 600, :height 370.8282, :padding {:top 10, :left 50, :bottom 20, :right 10}, :marks [{:type \"path\", :from {:data \"links\"}, :properties {:enter {:path {:field \"data.path\"}, :strokeWidth {:value 2}, :stroke {:r {:field \"data.r\"}, :g {:field \"data.g\"}, :b {:field \"data.b\"}}}}} {:type \"symbol\", :from {:data \"nodes\"}, :properties {:enter {:x {:field \"data.x\"}, :y {:field \"data.y\"}, :fill {:r {:field \"data.r\"}, :g {:field \"data.g\"}, :b {:field \"data.b\"}}, :fillOpacity {:value \"1\"}}, :update {:shape \"circle\", :size {:value 110}, :stroke [:value \"transparent\"]}}} {:type \"text\", :from {:data \"labels\"}, :properties {:enter {:x {:field \"data.x\"}, :y {:field \"data.y\"}, :align {:value \"left\"}, :dx {:value 10}, :fontSize {:value 15}, :fill {:value \"black\"}}, :update {:text {:field \"data.value\"}}}}], :data [{:name \"nodes\", :values [{:value 10, :x 30.0, :y 123.60939534505208, :r 155, :g 147, :b 9} {:value 20, :x 226.3636363636361, :y 123.60939534505208, :r 155, :g 147, :b 9} {:value 30, :x 422.72727272727235, :y 123.60939534505208, :r 155, :g 147, :b 9} {:value 40, :x 570.0, :y 123.60939534505208, :r 155, :g 147, :b 9} {:value 50, :x 471.81818181818124, :y 247.21879069010419, :r 76, :g 98, :b 19} {:value 60, :x 520.9090909090904, :y 247.21879069010419, :r 76, :g 98, :b 19} {:value 70, :x 570.0, :y 247.21879069010419, :r 76, :g 98, :b 19}]} {:name \"links\", :values [{:path \"M 30.000000447034836 123.60939902889913 L 226.3636350631714 123.60939902889913\", :r 155, :g 147, :b 9} {:path \"M 226.3636350631714 123.60939902889913 L 422.7272629737854 123.60939902889913\", :r 155, :g 147, :b 9} {:path \"M 422.7272629737854 123.60939902889913 L 569.9999928474426 123.60939902889913\", :r 155, :g 147, :b 9} {:path \"M 471.81819677352905 247.21879805779827 L 520.9090948104858 247.21879805779827\", :r 76, :g 98, :b 19} {:path \"M 520.9090948104858 247.21879805779827 L 569.9999928474426 247.21879805779827\", :r 76, :g 98, :b 19} {:path \"M 422.7272629737854 123.60939902889913 L 471.81819677352905 247.21879805779827\", :r 76, :g 98, :b 19}]} {:name \"labels\", :values [{:value \"master\", :x 570.0, :y 123.60939534505208} {:value \"dev\", :x 570.0, :y 247.21879069010419}]}]}}"}
;; <=

;; **
;;; Merge "master" and "dev" branch-heads:
;; **

;; @@
(swap! test-repo #(assoc-in % [:commit-graph 80] [70 40]))
(swap! test-repo #(assoc-in % [:commits 80] "master"))
(swap! test-repo #(assoc-in % [:branches "master"] #{80}))
(plot-graph @test-repo)
;; @@
;; =>
;;; {"type":"vega","content":{"width":600,"height":370.82818603515625,"padding":{"top":10,"left":50,"bottom":20,"right":10},"marks":[{"type":"path","from":{"data":"links"},"properties":{"enter":{"path":{"field":"data.path"},"strokeWidth":{"value":2},"stroke":{"r":{"field":"data.r"},"g":{"field":"data.g"},"b":{"field":"data.b"}}}}},{"type":"symbol","from":{"data":"nodes"},"properties":{"enter":{"x":{"field":"data.x"},"y":{"field":"data.y"},"fill":{"r":{"field":"data.r"},"g":{"field":"data.g"},"b":{"field":"data.b"}},"fillOpacity":{"value":"1"}},"update":{"shape":"circle","size":{"value":110},"stroke":["value","transparent"]}}},{"type":"text","from":{"data":"labels"},"properties":{"enter":{"x":{"field":"data.x"},"y":{"field":"data.y"},"align":{"value":"left"},"dx":{"value":10},"fontSize":{"value":15},"fill":{"value":"black"}},"update":{"text":{"field":"data.value"}}}}],"data":[{"name":"nodes","values":[{"value":10,"x":30.0,"y":123.60939534505208,"r":165,"g":112,"b":251},{"value":20,"x":191.99999999999946,"y":123.60939534505208,"r":165,"g":112,"b":251},{"value":30,"x":353.9999999999991,"y":123.60939534505208,"r":165,"g":112,"b":251},{"value":40,"x":461.99999999999943,"y":123.60939534505208,"r":165,"g":112,"b":251},{"value":80,"x":570.0,"y":123.60939534505208,"r":165,"g":112,"b":251},{"value":50,"x":407.9999999999988,"y":247.21879069010419,"r":98,"g":52,"b":49},{"value":60,"x":461.99999999999886,"y":247.21879069010419,"r":98,"g":52,"b":49},{"value":70,"x":515.9999999999992,"y":247.21879069010419,"r":98,"g":52,"b":49}]},{"name":"links","values":[{"path":"M 30.000000447034836 123.60939902889913 L 191.99999570846558 123.60939902889913","r":165,"g":112,"b":251},{"path":"M 191.99999570846558 123.60939902889913 L 353.9999842643738 123.60939902889913","r":165,"g":112,"b":251},{"path":"M 353.9999842643738 123.60939902889913 L 461.9999885559082 123.60939902889913","r":165,"g":112,"b":251},{"path":"M 461.9999885559082 123.60939902889913 L 569.9999928474426 123.60939902889913","r":165,"g":112,"b":251},{"path":"M 408.0000042915344 247.21879805779827 L 461.9999885559082 247.21879805779827","r":98,"g":52,"b":49},{"path":"M 461.9999885559082 247.21879805779827 L 516.0000085830688 247.21879805779827","r":98,"g":52,"b":49},{"path":"M 353.9999842643738 123.60939902889913 L 408.0000042915344 247.21879805779827","r":98,"g":52,"b":49},{"path":"M 569.9999928474426 123.60939902889913 L 516.0000085830688 247.21879805779827","r":98,"g":52,"b":49}]},{"name":"labels","values":[{"value":"master","x":570.0,"y":123.60939534505208},{"value":"dev","x":515.9999999999992,"y":247.21879069010419}]}]},"value":"#gorilla_repl.vega.VegaView{:content {:width 600, :height 370.8282, :padding {:top 10, :left 50, :bottom 20, :right 10}, :marks [{:type \"path\", :from {:data \"links\"}, :properties {:enter {:path {:field \"data.path\"}, :strokeWidth {:value 2}, :stroke {:r {:field \"data.r\"}, :g {:field \"data.g\"}, :b {:field \"data.b\"}}}}} {:type \"symbol\", :from {:data \"nodes\"}, :properties {:enter {:x {:field \"data.x\"}, :y {:field \"data.y\"}, :fill {:r {:field \"data.r\"}, :g {:field \"data.g\"}, :b {:field \"data.b\"}}, :fillOpacity {:value \"1\"}}, :update {:shape \"circle\", :size {:value 110}, :stroke [:value \"transparent\"]}}} {:type \"text\", :from {:data \"labels\"}, :properties {:enter {:x {:field \"data.x\"}, :y {:field \"data.y\"}, :align {:value \"left\"}, :dx {:value 10}, :fontSize {:value 15}, :fill {:value \"black\"}}, :update {:text {:field \"data.value\"}}}}], :data [{:name \"nodes\", :values [{:value 10, :x 30.0, :y 123.60939534505208, :r 165, :g 112, :b 251} {:value 20, :x 191.99999999999946, :y 123.60939534505208, :r 165, :g 112, :b 251} {:value 30, :x 353.9999999999991, :y 123.60939534505208, :r 165, :g 112, :b 251} {:value 40, :x 461.99999999999943, :y 123.60939534505208, :r 165, :g 112, :b 251} {:value 80, :x 570.0, :y 123.60939534505208, :r 165, :g 112, :b 251} {:value 50, :x 407.9999999999988, :y 247.21879069010419, :r 98, :g 52, :b 49} {:value 60, :x 461.99999999999886, :y 247.21879069010419, :r 98, :g 52, :b 49} {:value 70, :x 515.9999999999992, :y 247.21879069010419, :r 98, :g 52, :b 49}]} {:name \"links\", :values [{:path \"M 30.000000447034836 123.60939902889913 L 191.99999570846558 123.60939902889913\", :r 165, :g 112, :b 251} {:path \"M 191.99999570846558 123.60939902889913 L 353.9999842643738 123.60939902889913\", :r 165, :g 112, :b 251} {:path \"M 353.9999842643738 123.60939902889913 L 461.9999885559082 123.60939902889913\", :r 165, :g 112, :b 251} {:path \"M 461.9999885559082 123.60939902889913 L 569.9999928474426 123.60939902889913\", :r 165, :g 112, :b 251} {:path \"M 408.0000042915344 247.21879805779827 L 461.9999885559082 247.21879805779827\", :r 98, :g 52, :b 49} {:path \"M 461.9999885559082 247.21879805779827 L 516.0000085830688 247.21879805779827\", :r 98, :g 52, :b 49} {:path \"M 353.9999842643738 123.60939902889913 L 408.0000042915344 247.21879805779827\", :r 98, :g 52, :b 49} {:path \"M 569.9999928474426 123.60939902889913 L 516.0000085830688 247.21879805779827\", :r 98, :g 52, :b 49}]} {:name \"labels\", :values [{:value \"master\", :x 570.0, :y 123.60939534505208} {:value \"dev\", :x 515.9999999999992, :y 247.21879069010419}]}]}}"}
;; <=

;; **
;;; Commit to "dev" branch:
;; **

;; @@
(swap! test-repo #(assoc-in % [:commit-graph 90] [70]))
(swap! test-repo #(assoc-in % [:commits 90] "dev"))
(swap! test-repo #(assoc-in % [:branches "dev"] #{90}))
(plot-graph @test-repo)
;; @@
;; =>
;;; {"type":"vega","content":{"width":600,"height":370.82818603515625,"padding":{"top":10,"left":50,"bottom":20,"right":10},"marks":[{"type":"path","from":{"data":"links"},"properties":{"enter":{"path":{"field":"data.path"},"strokeWidth":{"value":2},"stroke":{"r":{"field":"data.r"},"g":{"field":"data.g"},"b":{"field":"data.b"}}}}},{"type":"symbol","from":{"data":"nodes"},"properties":{"enter":{"x":{"field":"data.x"},"y":{"field":"data.y"},"fill":{"r":{"field":"data.r"},"g":{"field":"data.g"},"b":{"field":"data.b"}},"fillOpacity":{"value":"1"}},"update":{"shape":"circle","size":{"value":110},"stroke":["value","transparent"]}}},{"type":"text","from":{"data":"labels"},"properties":{"enter":{"x":{"field":"data.x"},"y":{"field":"data.y"},"align":{"value":"left"},"dx":{"value":10},"fontSize":{"value":15},"fill":{"value":"black"}},"update":{"text":{"field":"data.value"}}}}],"data":[{"name":"nodes","values":[{"value":10,"x":30.0,"y":123.60939534505208,"r":159,"g":88,"b":229},{"value":20,"x":194.99999999999955,"y":123.60939534505208,"r":159,"g":88,"b":229},{"value":30,"x":359.99999999999926,"y":123.60939534505208,"r":159,"g":88,"b":229},{"value":40,"x":464.9999999999995,"y":123.60939534505208,"r":159,"g":88,"b":229},{"value":80,"x":570.0,"y":123.60939534505208,"r":159,"g":88,"b":229},{"value":50,"x":419.99999999999903,"y":247.21879069010419,"r":124,"g":242,"b":80},{"value":60,"x":479.99999999999915,"y":247.21879069010419,"r":124,"g":242,"b":80},{"value":70,"x":539.9999999999997,"y":247.21879069010419,"r":124,"g":242,"b":80},{"value":90,"x":570.0,"y":247.21879069010419,"r":124,"g":242,"b":80}]},{"name":"links","values":[{"path":"M 30.000000447034836 123.60939902889913 L 194.99999284744263 123.60939902889913","r":159,"g":88,"b":229},{"path":"M 194.99999284744263 123.60939902889913 L 360.00001430511475 123.60939902889913","r":159,"g":88,"b":229},{"path":"M 360.00001430511475 123.60939902889913 L 464.99998569488525 123.60939902889913","r":159,"g":88,"b":229},{"path":"M 464.99998569488525 123.60939902889913 L 569.9999928474426 123.60939902889913","r":159,"g":88,"b":229},{"path":"M 419.9999928474426 247.21879805779827 L 480.0000071525574 247.21879805779827","r":124,"g":242,"b":80},{"path":"M 480.0000071525574 247.21879805779827 L 539.9999856948853 247.21879805779827","r":124,"g":242,"b":80},{"path":"M 539.9999856948853 247.21879805779827 L 569.9999928474426 247.21879805779827","r":124,"g":242,"b":80},{"path":"M 360.00001430511475 123.60939902889913 L 419.9999928474426 247.21879805779827","r":124,"g":242,"b":80},{"path":"M 569.9999928474426 123.60939902889913 L 539.9999856948853 247.21879805779827","r":124,"g":242,"b":80}]},{"name":"labels","values":[{"value":"master","x":570.0,"y":123.60939534505208},{"value":"dev","x":570.0,"y":247.21879069010419}]}]},"value":"#gorilla_repl.vega.VegaView{:content {:width 600, :height 370.8282, :padding {:top 10, :left 50, :bottom 20, :right 10}, :marks [{:type \"path\", :from {:data \"links\"}, :properties {:enter {:path {:field \"data.path\"}, :strokeWidth {:value 2}, :stroke {:r {:field \"data.r\"}, :g {:field \"data.g\"}, :b {:field \"data.b\"}}}}} {:type \"symbol\", :from {:data \"nodes\"}, :properties {:enter {:x {:field \"data.x\"}, :y {:field \"data.y\"}, :fill {:r {:field \"data.r\"}, :g {:field \"data.g\"}, :b {:field \"data.b\"}}, :fillOpacity {:value \"1\"}}, :update {:shape \"circle\", :size {:value 110}, :stroke [:value \"transparent\"]}}} {:type \"text\", :from {:data \"labels\"}, :properties {:enter {:x {:field \"data.x\"}, :y {:field \"data.y\"}, :align {:value \"left\"}, :dx {:value 10}, :fontSize {:value 15}, :fill {:value \"black\"}}, :update {:text {:field \"data.value\"}}}}], :data [{:name \"nodes\", :values [{:value 10, :x 30.0, :y 123.60939534505208, :r 159, :g 88, :b 229} {:value 20, :x 194.99999999999955, :y 123.60939534505208, :r 159, :g 88, :b 229} {:value 30, :x 359.99999999999926, :y 123.60939534505208, :r 159, :g 88, :b 229} {:value 40, :x 464.9999999999995, :y 123.60939534505208, :r 159, :g 88, :b 229} {:value 80, :x 570.0, :y 123.60939534505208, :r 159, :g 88, :b 229} {:value 50, :x 419.99999999999903, :y 247.21879069010419, :r 124, :g 242, :b 80} {:value 60, :x 479.99999999999915, :y 247.21879069010419, :r 124, :g 242, :b 80} {:value 70, :x 539.9999999999997, :y 247.21879069010419, :r 124, :g 242, :b 80} {:value 90, :x 570.0, :y 247.21879069010419, :r 124, :g 242, :b 80}]} {:name \"links\", :values [{:path \"M 30.000000447034836 123.60939902889913 L 194.99999284744263 123.60939902889913\", :r 159, :g 88, :b 229} {:path \"M 194.99999284744263 123.60939902889913 L 360.00001430511475 123.60939902889913\", :r 159, :g 88, :b 229} {:path \"M 360.00001430511475 123.60939902889913 L 464.99998569488525 123.60939902889913\", :r 159, :g 88, :b 229} {:path \"M 464.99998569488525 123.60939902889913 L 569.9999928474426 123.60939902889913\", :r 159, :g 88, :b 229} {:path \"M 419.9999928474426 247.21879805779827 L 480.0000071525574 247.21879805779827\", :r 124, :g 242, :b 80} {:path \"M 480.0000071525574 247.21879805779827 L 539.9999856948853 247.21879805779827\", :r 124, :g 242, :b 80} {:path \"M 539.9999856948853 247.21879805779827 L 569.9999928474426 247.21879805779827\", :r 124, :g 242, :b 80} {:path \"M 360.00001430511475 123.60939902889913 L 419.9999928474426 247.21879805779827\", :r 124, :g 242, :b 80} {:path \"M 569.9999928474426 123.60939902889913 L 539.9999856948853 247.21879805779827\", :r 124, :g 242, :b 80}]} {:name \"labels\", :values [{:value \"master\", :x 570.0, :y 123.60939534505208} {:value \"dev\", :x 570.0, :y 247.21879069010419}]}]}}"}
;; <=

;; **
;;; Commit to "master" branch:
;; **

;; @@
(swap! test-repo #(assoc-in % [:commit-graph 100] [80]))
(swap! test-repo #(assoc-in % [:commits 100] "master"))
(swap! test-repo #(assoc-in % [:branches "master"] #{100}))
(plot-graph @test-repo)
;; @@
;; =>
;;; {"type":"vega","content":{"width":600,"height":370.82818603515625,"padding":{"top":10,"left":50,"bottom":20,"right":10},"marks":[{"type":"path","from":{"data":"links"},"properties":{"enter":{"path":{"field":"data.path"},"strokeWidth":{"value":2},"stroke":{"r":{"field":"data.r"},"g":{"field":"data.g"},"b":{"field":"data.b"}}}}},{"type":"symbol","from":{"data":"nodes"},"properties":{"enter":{"x":{"field":"data.x"},"y":{"field":"data.y"},"fill":{"r":{"field":"data.r"},"g":{"field":"data.g"},"b":{"field":"data.b"}},"fillOpacity":{"value":"1"}},"update":{"shape":"circle","size":{"value":110},"stroke":["value","transparent"]}}},{"type":"text","from":{"data":"labels"},"properties":{"enter":{"x":{"field":"data.x"},"y":{"field":"data.y"},"align":{"value":"left"},"dx":{"value":10},"fontSize":{"value":15},"fill":{"value":"black"}},"update":{"text":{"field":"data.value"}}}}],"data":[{"name":"nodes","values":[{"value":10,"x":30.0,"y":123.60939534505208,"r":16,"g":96,"b":204},{"value":20,"x":175.71428571427646,"y":123.60939534505208,"r":16,"g":96,"b":204},{"value":30,"x":321.42857142855587,"y":123.60939534505208,"r":16,"g":96,"b":204},{"value":40,"x":407.1428571428431,"y":123.60939534505208,"r":16,"g":96,"b":204},{"value":80,"x":492.8571428571344,"y":123.60939534505208,"r":16,"g":96,"b":204},{"value":100,"x":570.0,"y":123.60939534505208,"r":16,"g":96,"b":204},{"value":50,"x":381.4285714285529,"y":247.21879069010419,"r":145,"g":238,"b":26},{"value":60,"x":441.4285714285554,"y":247.21879069010419,"r":145,"g":238,"b":26},{"value":70,"x":501.4285714285625,"y":247.21879069010419,"r":145,"g":238,"b":26},{"value":90,"x":570.0,"y":247.21879069010419,"r":145,"g":238,"b":26}]},{"name":"links","values":[{"path":"M 30.000000447034836 123.60939902889913 L 175.71428418159485 123.60939902889913","r":16,"g":96,"b":204},{"path":"M 175.71428418159485 123.60939902889913 L 321.4285612106323 123.60939902889913","r":16,"g":96,"b":204},{"path":"M 321.4285612106323 123.60939902889913 L 407.1428418159485 123.60939902889913","r":16,"g":96,"b":204},{"path":"M 407.1428418159485 123.60939902889913 L 492.8571581840515 123.60939902889913","r":16,"g":96,"b":204},{"path":"M 492.8571581840515 123.60939902889913 L 569.9999928474426 123.60939902889913","r":16,"g":96,"b":204},{"path":"M 381.42857551574707 247.21879805779827 L 441.42855405807495 247.21879805779827","r":145,"g":238,"b":26},{"path":"M 441.42855405807495 247.21879805779827 L 501.4285683631897 247.21879805779827","r":145,"g":238,"b":26},{"path":"M 501.4285683631897 247.21879805779827 L 569.9999928474426 247.21879805779827","r":145,"g":238,"b":26},{"path":"M 321.4285612106323 123.60939902889913 L 381.42857551574707 247.21879805779827","r":145,"g":238,"b":26},{"path":"M 492.8571581840515 123.60939902889913 L 501.4285683631897 247.21879805779827","r":145,"g":238,"b":26}]},{"name":"labels","values":[{"value":"master","x":570.0,"y":123.60939534505208},{"value":"dev","x":570.0,"y":247.21879069010419}]}]},"value":"#gorilla_repl.vega.VegaView{:content {:width 600, :height 370.8282, :padding {:top 10, :left 50, :bottom 20, :right 10}, :marks [{:type \"path\", :from {:data \"links\"}, :properties {:enter {:path {:field \"data.path\"}, :strokeWidth {:value 2}, :stroke {:r {:field \"data.r\"}, :g {:field \"data.g\"}, :b {:field \"data.b\"}}}}} {:type \"symbol\", :from {:data \"nodes\"}, :properties {:enter {:x {:field \"data.x\"}, :y {:field \"data.y\"}, :fill {:r {:field \"data.r\"}, :g {:field \"data.g\"}, :b {:field \"data.b\"}}, :fillOpacity {:value \"1\"}}, :update {:shape \"circle\", :size {:value 110}, :stroke [:value \"transparent\"]}}} {:type \"text\", :from {:data \"labels\"}, :properties {:enter {:x {:field \"data.x\"}, :y {:field \"data.y\"}, :align {:value \"left\"}, :dx {:value 10}, :fontSize {:value 15}, :fill {:value \"black\"}}, :update {:text {:field \"data.value\"}}}}], :data [{:name \"nodes\", :values [{:value 10, :x 30.0, :y 123.60939534505208, :r 16, :g 96, :b 204} {:value 20, :x 175.71428571427646, :y 123.60939534505208, :r 16, :g 96, :b 204} {:value 30, :x 321.42857142855587, :y 123.60939534505208, :r 16, :g 96, :b 204} {:value 40, :x 407.1428571428431, :y 123.60939534505208, :r 16, :g 96, :b 204} {:value 80, :x 492.8571428571344, :y 123.60939534505208, :r 16, :g 96, :b 204} {:value 100, :x 570.0, :y 123.60939534505208, :r 16, :g 96, :b 204} {:value 50, :x 381.4285714285529, :y 247.21879069010419, :r 145, :g 238, :b 26} {:value 60, :x 441.4285714285554, :y 247.21879069010419, :r 145, :g 238, :b 26} {:value 70, :x 501.4285714285625, :y 247.21879069010419, :r 145, :g 238, :b 26} {:value 90, :x 570.0, :y 247.21879069010419, :r 145, :g 238, :b 26}]} {:name \"links\", :values [{:path \"M 30.000000447034836 123.60939902889913 L 175.71428418159485 123.60939902889913\", :r 16, :g 96, :b 204} {:path \"M 175.71428418159485 123.60939902889913 L 321.4285612106323 123.60939902889913\", :r 16, :g 96, :b 204} {:path \"M 321.4285612106323 123.60939902889913 L 407.1428418159485 123.60939902889913\", :r 16, :g 96, :b 204} {:path \"M 407.1428418159485 123.60939902889913 L 492.8571581840515 123.60939902889913\", :r 16, :g 96, :b 204} {:path \"M 492.8571581840515 123.60939902889913 L 569.9999928474426 123.60939902889913\", :r 16, :g 96, :b 204} {:path \"M 381.42857551574707 247.21879805779827 L 441.42855405807495 247.21879805779827\", :r 145, :g 238, :b 26} {:path \"M 441.42855405807495 247.21879805779827 L 501.4285683631897 247.21879805779827\", :r 145, :g 238, :b 26} {:path \"M 501.4285683631897 247.21879805779827 L 569.9999928474426 247.21879805779827\", :r 145, :g 238, :b 26} {:path \"M 321.4285612106323 123.60939902889913 L 381.42857551574707 247.21879805779827\", :r 145, :g 238, :b 26} {:path \"M 492.8571581840515 123.60939902889913 L 501.4285683631897 247.21879805779827\", :r 145, :g 238, :b 26}]} {:name \"labels\", :values [{:value \"master\", :x 570.0, :y 123.60939534505208} {:value \"dev\", :x 570.0, :y 247.21879069010419}]}]}}"}
;; <=

;; **
;;; Branch from earlier commits in "master"
;; **

;; @@
(swap! test-repo #(assoc-in % [:commit-graph 110] [20]))
(swap! test-repo #(assoc-in % [:commits 110] "hotfix"))
(swap! test-repo #(assoc-in % [:branches "hotfix"] #{110}))
(plot-graph @test-repo)
;; @@
;; =>
;;; {"type":"vega","content":{"width":600,"height":370.82818603515625,"padding":{"top":10,"left":50,"bottom":20,"right":10},"marks":[{"type":"path","from":{"data":"links"},"properties":{"enter":{"path":{"field":"data.path"},"strokeWidth":{"value":2},"stroke":{"r":{"field":"data.r"},"g":{"field":"data.g"},"b":{"field":"data.b"}}}}},{"type":"symbol","from":{"data":"nodes"},"properties":{"enter":{"x":{"field":"data.x"},"y":{"field":"data.y"},"fill":{"r":{"field":"data.r"},"g":{"field":"data.g"},"b":{"field":"data.b"}},"fillOpacity":{"value":"1"}},"update":{"shape":"circle","size":{"value":110},"stroke":["value","transparent"]}}},{"type":"text","from":{"data":"labels"},"properties":{"enter":{"x":{"field":"data.x"},"y":{"field":"data.y"},"align":{"value":"left"},"dx":{"value":10},"fontSize":{"value":15},"fill":{"value":"black"}},"update":{"text":{"field":"data.value"}}}}],"data":[{"name":"nodes","values":[{"value":10,"x":30.0,"y":185.41409301757812,"r":189,"g":49,"b":146},{"value":20,"x":342.11009174311886,"y":185.41409301757812,"r":189,"g":49,"b":146},{"value":30,"x":426.33027522935686,"y":185.41409301757812,"r":189,"g":49,"b":146},{"value":40,"x":475.87155963302655,"y":185.41409301757812,"r":189,"g":49,"b":146},{"value":80,"x":525.4128440366966,"y":185.41409301757812,"r":189,"g":49,"b":146},{"value":100,"x":570.0,"y":185.41409301757812,"r":189,"g":49,"b":146},{"value":50,"x":461.0091743119254,"y":92.70704650878906,"r":1,"g":119,"b":88},{"value":60,"x":495.6880733944943,"y":92.70704650878906,"r":1,"g":119,"b":88},{"value":70,"x":530.3669724770635,"y":92.70704650878906,"r":1,"g":119,"b":88},{"value":90,"x":570.0,"y":92.70704650878906,"r":1,"g":119,"b":88},{"value":110,"x":570.0,"y":278.1211395263672,"r":126,"g":200,"b":230}]},{"name":"links","values":[{"path":"M 30.000000447034836 185.41409301757812 L 342.11010932922363 185.41409301757812","r":189,"g":49,"b":146},{"path":"M 342.11010932922363 185.41409301757812 L 426.33029222488403 185.41409301757812","r":189,"g":49,"b":146},{"path":"M 426.33029222488403 185.41409301757812 L 475.8715510368347 185.41409301757812","r":189,"g":49,"b":146},{"path":"M 475.8715510368347 185.41409301757812 L 525.4128456115723 185.41409301757812","r":189,"g":49,"b":146},{"path":"M 525.4128456115723 185.41409301757812 L 569.9999928474426 185.41409301757812","r":189,"g":49,"b":146},{"path":"M 461.0091805458069 92.70704650878906 L 495.68806886672974 92.70704650878906","r":1,"g":119,"b":88},{"path":"M 495.68806886672974 92.70704650878906 L 530.3669571876526 92.70704650878906","r":1,"g":119,"b":88},{"path":"M 530.3669571876526 92.70704650878906 L 569.9999928474426 92.70704650878906","r":1,"g":119,"b":88},{"path":"M 426.33029222488403 185.41409301757812 L 461.0091805458069 92.70704650878906","r":1,"g":119,"b":88},{"path":"M 342.11010932922363 185.41409301757812 L 569.9999928474426 278.1211395263672","r":126,"g":200,"b":230},{"path":"M 525.4128456115723 185.41409301757812 L 530.3669571876526 92.70704650878906","r":1,"g":119,"b":88}]},{"name":"labels","values":[{"value":"master","x":570.0,"y":185.41409301757812},{"value":"dev","x":570.0,"y":92.70704650878906},{"value":"hotfix","x":570.0,"y":278.1211395263672}]}]},"value":"#gorilla_repl.vega.VegaView{:content {:width 600, :height 370.8282, :padding {:top 10, :left 50, :bottom 20, :right 10}, :marks [{:type \"path\", :from {:data \"links\"}, :properties {:enter {:path {:field \"data.path\"}, :strokeWidth {:value 2}, :stroke {:r {:field \"data.r\"}, :g {:field \"data.g\"}, :b {:field \"data.b\"}}}}} {:type \"symbol\", :from {:data \"nodes\"}, :properties {:enter {:x {:field \"data.x\"}, :y {:field \"data.y\"}, :fill {:r {:field \"data.r\"}, :g {:field \"data.g\"}, :b {:field \"data.b\"}}, :fillOpacity {:value \"1\"}}, :update {:shape \"circle\", :size {:value 110}, :stroke [:value \"transparent\"]}}} {:type \"text\", :from {:data \"labels\"}, :properties {:enter {:x {:field \"data.x\"}, :y {:field \"data.y\"}, :align {:value \"left\"}, :dx {:value 10}, :fontSize {:value 15}, :fill {:value \"black\"}}, :update {:text {:field \"data.value\"}}}}], :data [{:name \"nodes\", :values [{:value 10, :x 30.0, :y 185.41409301757812, :r 189, :g 49, :b 146} {:value 20, :x 342.11009174311886, :y 185.41409301757812, :r 189, :g 49, :b 146} {:value 30, :x 426.33027522935686, :y 185.41409301757812, :r 189, :g 49, :b 146} {:value 40, :x 475.87155963302655, :y 185.41409301757812, :r 189, :g 49, :b 146} {:value 80, :x 525.4128440366966, :y 185.41409301757812, :r 189, :g 49, :b 146} {:value 100, :x 570.0, :y 185.41409301757812, :r 189, :g 49, :b 146} {:value 50, :x 461.0091743119254, :y 92.70704650878906, :r 1, :g 119, :b 88} {:value 60, :x 495.6880733944943, :y 92.70704650878906, :r 1, :g 119, :b 88} {:value 70, :x 530.3669724770635, :y 92.70704650878906, :r 1, :g 119, :b 88} {:value 90, :x 570.0, :y 92.70704650878906, :r 1, :g 119, :b 88} {:value 110, :x 570.0, :y 278.1211395263672, :r 126, :g 200, :b 230}]} {:name \"links\", :values [{:path \"M 30.000000447034836 185.41409301757812 L 342.11010932922363 185.41409301757812\", :r 189, :g 49, :b 146} {:path \"M 342.11010932922363 185.41409301757812 L 426.33029222488403 185.41409301757812\", :r 189, :g 49, :b 146} {:path \"M 426.33029222488403 185.41409301757812 L 475.8715510368347 185.41409301757812\", :r 189, :g 49, :b 146} {:path \"M 475.8715510368347 185.41409301757812 L 525.4128456115723 185.41409301757812\", :r 189, :g 49, :b 146} {:path \"M 525.4128456115723 185.41409301757812 L 569.9999928474426 185.41409301757812\", :r 189, :g 49, :b 146} {:path \"M 461.0091805458069 92.70704650878906 L 495.68806886672974 92.70704650878906\", :r 1, :g 119, :b 88} {:path \"M 495.68806886672974 92.70704650878906 L 530.3669571876526 92.70704650878906\", :r 1, :g 119, :b 88} {:path \"M 530.3669571876526 92.70704650878906 L 569.9999928474426 92.70704650878906\", :r 1, :g 119, :b 88} {:path \"M 426.33029222488403 185.41409301757812 L 461.0091805458069 92.70704650878906\", :r 1, :g 119, :b 88} {:path \"M 342.11010932922363 185.41409301757812 L 569.9999928474426 278.1211395263672\", :r 126, :g 200, :b 230} {:path \"M 525.4128456115723 185.41409301757812 L 530.3669571876526 92.70704650878906\", :r 1, :g 119, :b 88}]} {:name \"labels\", :values [{:value \"master\", :x 570.0, :y 185.41409301757812} {:value \"dev\", :x 570.0, :y 92.70704650878906} {:value \"hotfix\", :x 570.0, :y 278.1211395263672}]}]}}"}
;; <=

;; @@
(swap! test-repo #(assoc-in % [:commit-graph 120] [110]))
(swap! test-repo #(assoc-in % [:commits 120] "hotfix"))
(swap! test-repo #(assoc-in % [:branches "hotfix"] #{120}))
(plot-graph @test-repo)
;; @@
;; =>
;;; {"type":"vega","content":{"width":600,"height":370.82818603515625,"padding":{"top":10,"left":50,"bottom":20,"right":10},"marks":[{"type":"path","from":{"data":"links"},"properties":{"enter":{"path":{"field":"data.path"},"strokeWidth":{"value":2},"stroke":{"r":{"field":"data.r"},"g":{"field":"data.g"},"b":{"field":"data.b"}}}}},{"type":"symbol","from":{"data":"nodes"},"properties":{"enter":{"x":{"field":"data.x"},"y":{"field":"data.y"},"fill":{"r":{"field":"data.r"},"g":{"field":"data.g"},"b":{"field":"data.b"}},"fillOpacity":{"value":"1"}},"update":{"shape":"circle","size":{"value":110},"stroke":["value","transparent"]}}},{"type":"text","from":{"data":"labels"},"properties":{"enter":{"x":{"field":"data.x"},"y":{"field":"data.y"},"align":{"value":"left"},"dx":{"value":10},"fontSize":{"value":15},"fill":{"value":"black"}},"update":{"text":{"field":"data.value"}}}}],"data":[{"name":"nodes","values":[{"value":10,"x":30.0,"y":185.41409301757812,"r":174,"g":224,"b":250},{"value":20,"x":281.1627906976735,"y":185.41409301757812,"r":174,"g":224,"b":250},{"value":30,"x":387.906976744184,"y":185.41409301757812,"r":174,"g":224,"b":250},{"value":40,"x":450.6976744186028,"y":185.41409301757812,"r":174,"g":224,"b":250},{"value":80,"x":513.4883720930221,"y":185.41409301757812,"r":174,"g":224,"b":250},{"value":100,"x":570.0,"y":185.41409301757812,"r":174,"g":224,"b":250},{"value":50,"x":431.86046511627643,"y":92.70704650878906,"r":200,"g":125,"b":14},{"value":60,"x":475.81395348836986,"y":92.70704650878906,"r":200,"g":125,"b":14},{"value":70,"x":519.7674418604639,"y":92.70704650878906,"r":200,"g":125,"b":14},{"value":90,"x":570.0,"y":92.70704650878906,"r":200,"g":125,"b":14},{"value":110,"x":425.58139534883657,"y":278.1211395263672,"r":200,"g":149,"b":22},{"value":120,"x":570.0,"y":278.1211395263672,"r":200,"g":149,"b":22}]},{"name":"links","values":[{"path":"M 30.000000447034836 185.41409301757812 L 281.1627924442291 185.41409301757812","r":174,"g":224,"b":250},{"path":"M 281.1627924442291 185.41409301757812 L 387.9069685935974 185.41409301757812","r":174,"g":224,"b":250},{"path":"M 387.9069685935974 185.41409301757812 L 450.697660446167 185.41409301757812","r":174,"g":224,"b":250},{"path":"M 450.697660446167 185.41409301757812 L 513.4883880615234 185.41409301757812","r":174,"g":224,"b":250},{"path":"M 513.4883880615234 185.41409301757812 L 569.9999928474426 185.41409301757812","r":174,"g":224,"b":250},{"path":"M 431.86047077178955 92.70704650878906 L 475.8139371871948 92.70704650878906","r":200,"g":125,"b":14},{"path":"M 475.8139371871948 92.70704650878906 L 519.767439365387 92.70704650878906","r":200,"g":125,"b":14},{"path":"M 519.767439365387 92.70704650878906 L 569.9999928474426 92.70704650878906","r":200,"g":125,"b":14},{"path":"M 425.58138370513916 278.1211395263672 L 569.9999928474426 278.1211395263672","r":200,"g":149,"b":22},{"path":"M 387.9069685935974 185.41409301757812 L 431.86047077178955 92.70704650878906","r":200,"g":125,"b":14},{"path":"M 281.1627924442291 185.41409301757812 L 425.58138370513916 278.1211395263672","r":200,"g":149,"b":22},{"path":"M 513.4883880615234 185.41409301757812 L 519.767439365387 92.70704650878906","r":200,"g":125,"b":14}]},{"name":"labels","values":[{"value":"master","x":570.0,"y":185.41409301757812},{"value":"dev","x":570.0,"y":92.70704650878906},{"value":"hotfix","x":570.0,"y":278.1211395263672}]}]},"value":"#gorilla_repl.vega.VegaView{:content {:width 600, :height 370.8282, :padding {:top 10, :left 50, :bottom 20, :right 10}, :marks [{:type \"path\", :from {:data \"links\"}, :properties {:enter {:path {:field \"data.path\"}, :strokeWidth {:value 2}, :stroke {:r {:field \"data.r\"}, :g {:field \"data.g\"}, :b {:field \"data.b\"}}}}} {:type \"symbol\", :from {:data \"nodes\"}, :properties {:enter {:x {:field \"data.x\"}, :y {:field \"data.y\"}, :fill {:r {:field \"data.r\"}, :g {:field \"data.g\"}, :b {:field \"data.b\"}}, :fillOpacity {:value \"1\"}}, :update {:shape \"circle\", :size {:value 110}, :stroke [:value \"transparent\"]}}} {:type \"text\", :from {:data \"labels\"}, :properties {:enter {:x {:field \"data.x\"}, :y {:field \"data.y\"}, :align {:value \"left\"}, :dx {:value 10}, :fontSize {:value 15}, :fill {:value \"black\"}}, :update {:text {:field \"data.value\"}}}}], :data [{:name \"nodes\", :values [{:value 10, :x 30.0, :y 185.41409301757812, :r 174, :g 224, :b 250} {:value 20, :x 281.1627906976735, :y 185.41409301757812, :r 174, :g 224, :b 250} {:value 30, :x 387.906976744184, :y 185.41409301757812, :r 174, :g 224, :b 250} {:value 40, :x 450.6976744186028, :y 185.41409301757812, :r 174, :g 224, :b 250} {:value 80, :x 513.4883720930221, :y 185.41409301757812, :r 174, :g 224, :b 250} {:value 100, :x 570.0, :y 185.41409301757812, :r 174, :g 224, :b 250} {:value 50, :x 431.86046511627643, :y 92.70704650878906, :r 200, :g 125, :b 14} {:value 60, :x 475.81395348836986, :y 92.70704650878906, :r 200, :g 125, :b 14} {:value 70, :x 519.7674418604639, :y 92.70704650878906, :r 200, :g 125, :b 14} {:value 90, :x 570.0, :y 92.70704650878906, :r 200, :g 125, :b 14} {:value 110, :x 425.58139534883657, :y 278.1211395263672, :r 200, :g 149, :b 22} {:value 120, :x 570.0, :y 278.1211395263672, :r 200, :g 149, :b 22}]} {:name \"links\", :values [{:path \"M 30.000000447034836 185.41409301757812 L 281.1627924442291 185.41409301757812\", :r 174, :g 224, :b 250} {:path \"M 281.1627924442291 185.41409301757812 L 387.9069685935974 185.41409301757812\", :r 174, :g 224, :b 250} {:path \"M 387.9069685935974 185.41409301757812 L 450.697660446167 185.41409301757812\", :r 174, :g 224, :b 250} {:path \"M 450.697660446167 185.41409301757812 L 513.4883880615234 185.41409301757812\", :r 174, :g 224, :b 250} {:path \"M 513.4883880615234 185.41409301757812 L 569.9999928474426 185.41409301757812\", :r 174, :g 224, :b 250} {:path \"M 431.86047077178955 92.70704650878906 L 475.8139371871948 92.70704650878906\", :r 200, :g 125, :b 14} {:path \"M 475.8139371871948 92.70704650878906 L 519.767439365387 92.70704650878906\", :r 200, :g 125, :b 14} {:path \"M 519.767439365387 92.70704650878906 L 569.9999928474426 92.70704650878906\", :r 200, :g 125, :b 14} {:path \"M 425.58138370513916 278.1211395263672 L 569.9999928474426 278.1211395263672\", :r 200, :g 149, :b 22} {:path \"M 387.9069685935974 185.41409301757812 L 431.86047077178955 92.70704650878906\", :r 200, :g 125, :b 14} {:path \"M 281.1627924442291 185.41409301757812 L 425.58138370513916 278.1211395263672\", :r 200, :g 149, :b 22} {:path \"M 513.4883880615234 185.41409301757812 L 519.767439365387 92.70704650878906\", :r 200, :g 125, :b 14}]} {:name \"labels\", :values [{:value \"master\", :x 570.0, :y 185.41409301757812} {:value \"dev\", :x 570.0, :y 92.70704650878906} {:value \"hotfix\", :x 570.0, :y 278.1211395263672}]}]}}"}
;; <=

;; @@

;; @@
